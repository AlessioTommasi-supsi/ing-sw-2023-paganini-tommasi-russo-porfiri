


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > Player</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.project.ingsw2023PaganiniTommasiRussoPorfiri.model</a>
</div>

<h1>Coverage Summary for Class: Player (org.project.ingsw2023PaganiniTommasiRussoPorfiri.model)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Player</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (29/29)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    89,2%
  </span>
  <span class="absValue">
    (132/148)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package org.project.ingsw2023PaganiniTommasiRussoPorfiri.model;
&nbsp;
&nbsp;import org.project.ingsw2023PaganiniTommasiRussoPorfiri.utils.FullLibraryException;
&nbsp;import org.project.ingsw2023PaganiniTommasiRussoPorfiri.utils.IllegalColumnException;
&nbsp;import org.project.ingsw2023PaganiniTommasiRussoPorfiri.utils.IllegalSizeOfTilesException;
&nbsp;
&nbsp;import java.io.Serializable;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.HashMap;
&nbsp;import java.util.Set;
&nbsp;
&nbsp;public class Player implements Serializable {
&nbsp;
&nbsp;    private int id;
&nbsp;    private String username;
&nbsp;    //USERNAME DEVE ESSERE UNIVOCO
&nbsp;    private boolean yourTurn;
&nbsp;    private Shelves shelves;
&nbsp;    private PersonalCard pC;
<b class="fc">&nbsp;    private int score = 0;  //aggiornato a ogni turno per quanto riguarda obiettivi comuni</b>
<b class="fc">&nbsp;    private boolean isCommonCard1Completed = false;</b>
<b class="fc">&nbsp;    private boolean isCommonCard2Completed = false;</b>
<b class="fc">&nbsp;    private HashMap&lt;Integer, Integer&gt; givenAdjacencyPoints = new HashMap&lt;&gt;();</b>
&nbsp;
<b class="fc">&nbsp;    public Player(Player p) {</b>
<b class="fc">&nbsp;        this.id = p.getId();</b>
<b class="fc">&nbsp;        this.username = p.getUsername();</b>
<b class="fc">&nbsp;        this.yourTurn = p.getTurn();</b>
<b class="fc">&nbsp;        this.shelves = p.getShelves();</b>
<b class="fc">&nbsp;        this.pC = p.getPC();</b>
<b class="fc">&nbsp;        this.score = p.getScore();</b>
<b class="fc">&nbsp;        defineAdjacencyPoints();</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    public Player(String username) {</b>
&nbsp;        //this.id = Globals.incrementPlayerId();//non puo funzionare dara sempre 1 perché ogni client esegue un nuovo programma!
<b class="fc">&nbsp;        this.id = -1;// -1 e poi viene assegnato id giusto da controller non appena si fa join_game!</b>
<b class="fc">&nbsp;        this.username = username;</b>
<b class="fc">&nbsp;        this.yourTurn = false;</b>
<b class="fc">&nbsp;        this.shelves = new Shelves();</b>
<b class="fc">&nbsp;        this.pC = null;</b>
<b class="fc">&nbsp;        this.score = 0;</b>
<b class="fc">&nbsp;        defineAdjacencyPoints();</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setId(int id) {
<b class="fc">&nbsp;        this.id = id;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isCommonCard1Completed() {
<b class="fc">&nbsp;        return isCommonCard1Completed;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isCommonCard2Completed() {
<b class="fc">&nbsp;        return isCommonCard2Completed;</b>
&nbsp;    }
&nbsp;
&nbsp;    public PersonalCard getPC() {
<b class="fc">&nbsp;        return pC;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean getTurn() {
<b class="fc">&nbsp;        return yourTurn;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getUsername() {
<b class="fc">&nbsp;        return username;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getId() {
<b class="fc">&nbsp;        return id;</b>
&nbsp;    }
&nbsp;
&nbsp;    public Shelves getShelves() {
<b class="fc">&nbsp;        return shelves;</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    public Player(int id, String username, PersonalCard pC) {</b>
<b class="fc">&nbsp;        this.id = id;</b>
<b class="fc">&nbsp;        this.username = username;</b>
<b class="fc">&nbsp;        this.yourTurn = false;</b>
<b class="fc">&nbsp;        this.shelves = new Shelves();</b>
<b class="fc">&nbsp;        this.pC = pC;</b>
<b class="fc">&nbsp;        defineAdjacencyPoints();</b>
&nbsp;    }
&nbsp;
&nbsp;    // Da inserire nel costruttore se ritenuto necessario
&nbsp;    public void setPC(PersonalCard pc) {
<b class="fc">&nbsp;        this.pC = pc;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setCommonCard1Completed(boolean commonCard1Completed) {
<b class="fc">&nbsp;        isCommonCard1Completed = commonCard1Completed;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setCommonCard2Completed(boolean commonCard2Completed) {
<b class="fc">&nbsp;        isCommonCard2Completed = commonCard2Completed;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void defineAdjacencyPoints() {
&nbsp;        // Inizializzazione dell&#39;HashMap con le associazioni tra counter e punti
<b class="fc">&nbsp;        givenAdjacencyPoints.put(3, 2);</b>
<b class="fc">&nbsp;        givenAdjacencyPoints.put(4, 3);</b>
<b class="fc">&nbsp;        givenAdjacencyPoints.put(5, 5);</b>
<b class="fc">&nbsp;        givenAdjacencyPoints.put(6, 8);</b>
&nbsp;    }
&nbsp;
&nbsp;    public void putTile(Set&lt;TilePositionShelves&gt; pt) {
<b class="fc">&nbsp;        for (TilePositionShelves p : pt) {</b>
<b class="fc">&nbsp;            shelves.addTile(p);</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    public void addPoints(int add) {
<b class="fc">&nbsp;        this.score += add;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setScore(int score) {
<b class="fc">&nbsp;        this.score = score;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getScore() {
<b class="fc">&nbsp;        return score;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void setShelves(Shelves shelves) {
<b class="fc">&nbsp;        this.shelves = shelves;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int checkPersonalCard(PersonalCard myPersonalCard) {
<b class="fc">&nbsp;        int counter = 0;</b>
&nbsp;        try {
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.CatXPosition, myPersonalCard.CatYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.CatXPosition, myPersonalCard.CatYPosition).getTile().getType() == TileType.CAT)) {</b>
<b class="nc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.BookXPosition, myPersonalCard.BookYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.BookXPosition, myPersonalCard.BookYPosition).getTile().getType() == TileType.BOOK)) {</b>
<b class="fc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.FrameXPosition, myPersonalCard.FrameYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.FrameXPosition, myPersonalCard.FrameYPosition).getTile().getType() == TileType.FRAME)) {</b>
<b class="nc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.TrophyXPosition, myPersonalCard.TrophyYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.TrophyXPosition, myPersonalCard.TrophyYPosition).getTile().getType() == TileType.TROPHY)) {</b>
<b class="fc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.GamesXPosition, myPersonalCard.GamesYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.GamesXPosition, myPersonalCard.GamesYPosition).getTile().getType() == TileType.GAMES )) {</b>
<b class="nc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="fc">&nbsp;            if ((getShelves().getTilePosition(myPersonalCard.PlantXPosition, myPersonalCard.PlantYPosition).isOccupied()) &amp;&amp;</b>
<b class="fc">&nbsp;                    (getShelves().getTilePosition(myPersonalCard.PlantXPosition, myPersonalCard.PlantYPosition).getTile().getType() == TileType.PLANT)) {</b>
<b class="nc">&nbsp;                counter++;</b>
&nbsp;            }
<b class="nc">&nbsp;        }catch (NullPointerException e){</b>
<b class="nc">&nbsp;            System.err.println(&quot;Shelves not initialized.&quot;);</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return counter;</b>
&nbsp;    }
&nbsp;
&nbsp;    public void addEndOfGamePoint(){
<b class="fc">&nbsp;        this.score+=1;</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public String toString() {
<b class="fc">&nbsp;        return &quot;Player{&quot; +</b>
&nbsp;                &quot;id=&quot; + id +
&nbsp;                &quot;, username=&#39;&quot; + username + &#39;\&#39;&#39; +
&nbsp;                &quot;, yourTurn=&quot; + yourTurn +
&nbsp;                &quot;, shelves=&quot; + shelves +
&nbsp;                &quot;, pC=&quot; + pC +
&nbsp;                &quot;, score=&quot; + score +
&nbsp;                &#39;}&#39;;
&nbsp;    }
&nbsp;
&nbsp;    public int calculatePersonalPoints() {
&nbsp;        int counter;
<b class="fc">&nbsp;        int pointAdded = 0;</b>
<b class="fc">&nbsp;        counter = this.checkPersonalCard(getPC());</b>
<b class="fc">&nbsp;        if (counter == 1) {</b>
<b class="fc">&nbsp;            pointAdded++;</b>
<b class="fc">&nbsp;        } else if (counter == 2) {</b>
<b class="nc">&nbsp;            pointAdded = 2;</b>
<b class="fc">&nbsp;        } else if (counter == 3) {</b>
<b class="nc">&nbsp;            pointAdded = 4;</b>
<b class="fc">&nbsp;        } else if (counter == 4) {</b>
<b class="nc">&nbsp;            pointAdded = 6;</b>
<b class="fc">&nbsp;        } else if (counter == 5) {</b>
<b class="nc">&nbsp;            pointAdded = 9;</b>
<b class="fc">&nbsp;        } else if (counter == 6) {</b>
<b class="nc">&nbsp;            pointAdded = 12;</b>
&nbsp;        }
<b class="fc">&nbsp;        return pointAdded;</b>
&nbsp;        //return pC.checkPersonalCard(new PersonalCardParser(), this);
&nbsp;    }
&nbsp;
&nbsp;    public int calculateAdjacentPoints() {
<b class="fc">&nbsp;        int tilesCounter = 0;</b>
<b class="fc">&nbsp;        int totalPoints = 0;</b>
<b class="fc">&nbsp;        boolean[][] visited = new boolean[6][5];</b>
&nbsp;
<b class="fc">&nbsp;        for (int row = 0; row &lt; 6; row++) {</b>
<b class="fc">&nbsp;            for (int col = 0; col &lt; 5; col++) {</b>
<b class="fc">&nbsp;                visited[row][col] = false;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        // Scansione delle tessere nello Shelf
<b class="fc">&nbsp;        for (int row = 0; row &lt; 6; row++) {</b>
<b class="fc">&nbsp;            for (int col = 0; col &lt; 5; col++) {</b>
<b class="fc">&nbsp;                if(visited[row][col]) {</b>
<b class="fc">&nbsp;                    continue;</b>
&nbsp;                }
&nbsp;                try {
<b class="fc">&nbsp;                    tilesCounter = calculateGroupCounter(row, col, visited, 1, shelves.getTilePosition(col, row).getTile().getType());</b>
<b class="fc">&nbsp;                }catch (Exception e){//succede quando tessere in shelves vuote</b>
<b class="fc">&nbsp;                    continue;</b>
<b class="fc">&nbsp;                }</b>
&nbsp;                // Serve per la HashMap
<b class="fc">&nbsp;                if(tilesCounter &gt; 6) {</b>
<b class="nc">&nbsp;                    tilesCounter = 6;</b>
&nbsp;                }
<b class="fc">&nbsp;                totalPoints += givenAdjacencyPoints.get(tilesCounter);</b>
&nbsp;            }
&nbsp;
&nbsp;        }
<b class="fc">&nbsp;        return totalPoints;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isValidPosition(int row, int col){
<b class="fc">&nbsp;        if (row &lt; 0 || row &gt;= 6 || col &lt; 0 || col &gt;= 5) {</b>
<b class="fc">&nbsp;            return false;</b>
&nbsp;        }
<b class="fc">&nbsp;        else return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    private int calculateGroupCounter(int row, int col, boolean[][] visited, int counter, TileType prevType) {
&nbsp;        TileObj currentTile;
&nbsp;
<b class="fc">&nbsp;        if (row &lt; 0 || row &gt;= 6 || col &lt; 0 || col &gt;= 5 || visited[row][col]) {</b>
<b class="fc">&nbsp;            counter = 0;</b>
<b class="fc">&nbsp;            return counter;</b>
&nbsp;        }
<b class="fc">&nbsp;        if(!(shelves.getTilePosition(row, col).getTile().getType().equals(prevType))){</b>
<b class="nc">&nbsp;            return counter;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        visited[row][col] = true;</b>
<b class="fc">&nbsp;        counter ++;</b>
<b class="fc">&nbsp;        currentTile = this.shelves.getTilePosition(row, col).getTile();</b>
&nbsp;
<b class="fc">&nbsp;        if (isValidPosition(row-1,col) &amp;&amp; this.shelves.getTilePosition(row - 1, col).isOccupied() &amp;&amp;</b>
<b class="fc">&nbsp;                this.shelves.getTilePosition(row - 1, col).getTile().getType().equals(currentTile.getType())) {</b>
<b class="fc">&nbsp;            counter += calculateGroupCounter(row - 1, col, visited, counter, prevType);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (isValidPosition(row+1,col) &amp;&amp; shelves.getTilePosition(row + 1, col).getTile() != null &amp;&amp; shelves.getTilePosition(row + 1, col).getTile().getType().equals(currentTile.getType())) {</b>
<b class="fc">&nbsp;            counter += calculateGroupCounter(row + 1, col, visited, counter, prevType);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (isValidPosition(row,col-1) &amp;&amp; shelves.getTilePosition(row, col-1).getTile() != null &amp;&amp; shelves.getTilePosition(row, col-1).getTile().getType().equals(currentTile.getType())) {</b>
<b class="fc">&nbsp;            counter += calculateGroupCounter(row, col - 1, visited, counter, prevType);</b>
&nbsp;        }
<b class="fc">&nbsp;        if (isValidPosition(row,col+1) &amp;&amp; shelves.getTilePosition(row, col+1).getTile() != null &amp;&amp; shelves.getTilePosition(row, col+1).getTile().getType().equals(currentTile.getType())) {</b>
<b class="fc">&nbsp;            counter += calculateGroupCounter(row, col + 1, visited, counter, prevType);</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if(counter &gt; 6) {</b>
<b class="fc">&nbsp;            counter = 6;</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        return counter;</b>
&nbsp;    }
&nbsp;
&nbsp;    //da chiamato in Game::end()!
&nbsp;    public void calcOverallScore() throws Exception {
<b class="fc">&nbsp;        this.score +=  calculatePersonalPoints() + calculateAdjacentPoints();</b>
&nbsp;    }
&nbsp;
&nbsp;    // manca un putTyle in shelves che accetta solo la colonna in cui io devo aggiungere le tiles!
&nbsp;    // qualcosa che avevamo detto essere gravity?
&nbsp;    public void putTilesInShelf(ArrayList&lt;TileObj&gt; tilesToPut, int col, int ordine[]) throws Exception {
&nbsp;        /*TODO!
&nbsp;        * ricorda genera eccezione
&nbsp;        * se non riesce a mettere le tiles
&nbsp;            -&gt; libreria piena, in questa colonna non ci possono stare quel numero di tiles   IllegalSizeOfTilesException
&nbsp;            -&gt; colonna non giusta   IllegalColumnException
&nbsp;        * se riesce a mettere le tiles
&nbsp;        *   con le tiles immesse la libreria  diventa piena     FullLibraryException
&nbsp;        * */
&nbsp;
<b class="fc">&nbsp;        ArrayList&lt;TileObj&gt; orderedTilesToRemove = new ArrayList&lt;&gt;();</b>
&nbsp;        //ordinamento per immissione in libreria
&nbsp;
<b class="fc">&nbsp;        for (int i = 0; i &lt; tilesToPut.size(); i++) {</b>
<b class="fc">&nbsp;            orderedTilesToRemove.add(tilesToPut.get(ordine[i] - 1));</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        tilesToPut = orderedTilesToRemove;</b>
&nbsp;
<b class="fc">&nbsp;        int countTilesInColumn = 0;</b>
<b class="fc">&nbsp;        for(int i = 0; i &lt; 6;i++) {</b>
<b class="fc">&nbsp;            if (shelves.getTilePosition2(col, i).getTile() != null) {</b>
<b class="nc">&nbsp;                countTilesInColumn++;</b>
&nbsp;            } else {
&nbsp;                break;
&nbsp;            }
&nbsp;        }
&nbsp;
&nbsp;        //.DEBUG
&nbsp;        //System.out.println(&quot;countTilesInColumn: &quot; + countTilesInColumn + &quot; col: &quot; + col);
&nbsp;        //for(int i = 0; i &lt; tilesToPut.size();i++) {
&nbsp;        //    System.out.println(&quot;tile: &quot; + tilesToPut.get(i));
&nbsp;        //}
&nbsp;
<b class="fc">&nbsp;        if((col &gt; 4)  || (col &lt; 0))</b>
<b class="nc">&nbsp;            throw new IllegalColumnException();</b>
<b class="fc">&nbsp;        if(tilesToPut.size() &gt; shelves.getMaxRows() - countTilesInColumn)</b>
<b class="nc">&nbsp;            throw new IllegalSizeOfTilesException(tilesToPut.size());</b>
&nbsp;
<b class="fc">&nbsp;        for (TileObj tileObj : tilesToPut) {</b>
<b class="fc">&nbsp;            shelves.getTilePosition2(col, countTilesInColumn).setTile(tileObj);</b>
<b class="fc">&nbsp;            countTilesInColumn++;</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        if (shelves.getFilledCounter() == 30) throw new FullLibraryException();</b>
&nbsp;    }
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-06-29 23:48</div>
</div>
</body>
</html>
